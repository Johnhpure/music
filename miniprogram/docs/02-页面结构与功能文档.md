# AI音乐创作助手 - 页面结构与功能文档

## 1. 页面导航结构

### 1.1 TabBar页面（底部导航）

```
┌────────┬────────┬────────┐
│  首页  │  创作  │  我的  │
└────────┴────────┴────────┘
```

| 页面 | 路径 | 图标 | 功能 |
|------|------|------|------|
| 首页 | /pages/index/index | home | 推荐内容、快速入口 |
| 创作 | /pages/creation/select | project | 创作歌曲 |
| 我的 | /pages/user/index | user | 个人中心 |

### 1.2 完整页面列表

#### 分类1: 首页模块
- `/pages/index/index` - 首页

#### 分类2: 创作模块
- `/pages/creation/select` - 选择创作方式
- `/pages/creation/ai` - AI辅助创作
- `/pages/creation/manual` - 自主创作
- `/pages/creation/style` - 风格选择
- `/pages/creation/preview` - 音乐预览生成

#### 分类3: 推荐模块
- `/pages/recommendations/index` - 热门推荐

#### 分类4: 教程模块
- `/pages/tutorial/index` - 教程主页
- `/pages/tutorial/ai` - AI创作教程
- `/pages/tutorial/self` - 自主创作教程

#### 分类5: 用户模块
- `/pages/user/index` - 个人中心
- `/pages/user/works` - 我的作品
- `/pages/user/work-detail` - 作品详情
- `/pages/user/points` - 积分中心
- `/pages/user/checkin` - 每日签到
- `/pages/user/purchase` - 购买点数
- `/pages/user/settings` - 系统设置
- `/pages/user/agreement` - 用户协议
- `/pages/user/privacy` - 隐私政策
- `/pages/user/copyright` - 版权说明
- `/pages/user/help` - 帮助中心
- `/pages/user/feedback` - 意见反馈
- `/pages/user/about` - 关于我们

---

## 2. 页面详细功能说明

### 2.1 首页 (`/pages/index/index`)

**页面定位**: 应用首页，展示核心功能入口和推荐内容

**UI布局**:
```
┌───────────────────────────────┐
│  顶部导航栏 + 音乐点数显示      │
├───────────────────────────────┤
│  功能介绍轮播（3张）           │
├───────────────────────────────┤
│  为您推荐创作作品标题          │
├───────────────────────────────┤
│  新手指引（自主创作/AI创作）   │
├───────────────────────────────┤
│  创作提示词（横向滚动）        │
│  • 夏日海滩                   │
│  • 甜蜜爱情                   │
│  • 城市夜景                   │
├───────────────────────────────┤
│  热门推荐（最多5首）           │
│  • 夏日海滩 - 电子 - 3:45    │
│  • 电子节拍 - 电子 - 4:12    │
├───────────────────────────────┤
│  创作教程（横向滚动）          │
└───────────────────────────────┘
```

**核心功能**:

1. **顶部导航栏**
   - 显示应用标题 "AI音乐创作"
   - 显示当前音乐点数（点击跳转到积分中心）

2. **功能轮播**
   - 3张轮播图
   - 自动播放，5秒切换
   - 展示核心功能介绍

3. **新手指引**
   - 自主创作教程卡片
   - AI辅助创作教程卡片
   - 点击跳转到对应教程页面

4. **创作提示词模板**
   - 横向滚动展示5个提示词模板
   - 每个模板包含：图标、标题、描述、标签
   - 点击模板跳转到AI创作页面并自动填充提示词

5. **热门推荐**
   - 显示5首热门音乐作品
   - 每首包含：封面、标题、风格、时长、播放次数、标签
   - 点击播放按钮预览音乐
   - 点击作品卡片查看详情

6. **创作教程**
   - 横向滚动展示3个教程
   - 每个教程包含：封面、标题、时长、难度级别
   - 点击跳转到教程页面

**数据结构（当前为模拟数据）**:

```javascript
// 轮播数据
banners: [
  { title, description, imageUrl }
]

// 提示词模板
promptTemplates: [
  { id, title, content, icon, iconBg, tags }
]

// 热门推荐
hotRecommendations: [
  { id, title, genre, duration, coverUrl, playCount, tags }
]

// 教程列表
tutorials: [
  { id, title, duration, level, coverUrl }
]
```

**交互逻辑**:
- 点击音乐点数 → 跳转到积分中心
- 点击新手指引 → 跳转到教程页面
- 点击提示词模板 → 跳转到AI创作页面（携带模板ID和标题）
- 点击热门推荐作品 → 跳转到作品详情页
- 点击播放按钮 → 播放音乐预览
- 点击"查看全部" → 跳转到推荐页面
- 点击教程卡片 → 跳转到教程详情

---

### 2.2 创作选择页 (`/pages/creation/select`)

**页面定位**: 用户选择创作方式（AI创作或自主创作）

**UI布局**:
```
┌───────────────────────────────┐
│      选择创作方式（标题）       │
├───────────────────────────────┤
│  ┌─────────────────────────┐  │
│  │  ✏️ 自己写歌词           │  │
│  │  自由发挥创意...         │  │
│  │                    →    │  │
│  └─────────────────────────┘  │
├───────────────────────────────┤
│  ┌─────────────────────────┐  │
│  │  ✏️ AI 帮我写            │  │
│  │  告诉AI你的想法...       │  │
│  │                    →    │  │
│  └─────────────────────────┘  │
├───────────────────────────────┤
│  首次创作将获得额外10点奖励    │
└───────────────────────────────┘
```

**核心功能**:

1. **自主创作入口**
   - 蓝色渐变卡片
   - 点击跳转到自主创作页面
   - 首次创作显示版权弹窗

2. **AI创作入口**
   - 紫色渐变卡片
   - 点击跳转到AI创作页面
   - 首次创作显示版权弹窗

3. **首次创作检测**
   - 检查本地存储的 `hasCreatedBefore` 标记
   - 首次创作显示版权说明弹窗
   - 用户同意后记录标记

**交互逻辑**:
- 点击"自己写歌词" → 
  - 检查是否首次创作
  - 首次：显示版权弹窗
  - 非首次：直接跳转到 `/pages/creation/manual`
  
- 点击"AI帮我写" → 
  - 检查是否首次创作
  - 首次：显示版权弹窗
  - 非首次：直接跳转到 `/pages/creation/ai`

---

### 2.3 AI辅助创作页 (`/pages/creation/ai`)

**页面定位**: 通过AI生成歌词内容

**UI布局**:
```
┌───────────────────────────────┐
│  < 返回    AI创作    帮助 ?   │
├───────────────────────────────┤
│  ┌ 新手指引弹窗（可关闭）───┐  │
│  │ 1. 选择创作提示词        │  │
│  │ 2. 生成并编辑歌词        │  │
│  │ 3. 选择音乐风格          │  │
│  │ 4. 生成并保存音乐        │  │
│  └─────────────────────────┘  │
├───────────────────────────────┤
│  告诉AI你想创作什么样的歌曲    │
│  ┌─────────────────────────┐  │
│  │ [输入框 最多100字]       │  │
│  └─────────────────────────┘  │
├───────────────────────────────┤
│  选择创作模版                 │
│  ← [爱情] [友情] [励志] →     │
│  ┌─────┐ ┌─────┐ ┌─────┐    │
│  │模板1│ │模板2│ │模板3│    │
│  └─────┘ └─────┘ └─────┘    │
├───────────────────────────────┤
│  [生成歌词] 将消耗10点数       │
└───────────────────────────────┘
```

**生成后布局**:
```
┌───────────────────────────────┐
│  版本1  |  版本2               │
├───────────────────────────────┤
│  歌曲标题                      │
│  ┌─────────────────────────┐  │
│  │ [输入框 最多30字]        │  │
│  └─────────────────────────┘  │
├───────────────────────────────┤
│  歌词内容           400/400   │
│  ┌─────────────────────────┐  │
│  │ [Verse 1]               │  │
│  │ 歌词内容...             │  │
│  │ [Chorus]                │  │
│  │ 歌词内容...             │  │
│  └─────────────────────────┘  │
├───────────────────────────────┤
│  [返回修改提示词] [继续创作]  │
└───────────────────────────────┘
```

**核心功能**:

1. **新手指引**
   - 首次进入显示指引弹窗
   - 介绍AI创作的4个步骤
   - 可关闭，下次不再显示

2. **提示词输入**
   - 自定义输入（最多100字）
   - 实时字数统计
   - 输入验证

3. **提示词分类**
   - 7个分类：全部、爱情、友情、励志、思念、青春、情感
   - 横向滚动切换分类
   - 当前分类高亮显示

4. **提示词模板**
   - 8个预设模板
   - 根据分类筛选显示
   - 点击选中模板，自动填充到输入框
   - 支持编辑修改

5. **歌词生成**
   - 点击"生成歌词"按钮
   - 显示生成中动画（10-15秒）
   - 模拟生成2个版本的歌词
   - 消耗10音乐点数

6. **版本切换**
   - Tab切换查看不同版本
   - 每个版本可独立编辑
   - 选择喜欢的版本继续

7. **歌词编辑**
   - 标题输入（最多30字）
   - 歌词展示（最多400字）
   - 可编辑修改（功能待完善）

**数据结构**:

```javascript
// 提示词分类
promptCategories: [
  { name: '全部', id: 'all' },
  { name: '爱情', id: 'love' },
  // ...
]

// 提示词模板
promptTemplates: [
  { id, category, content }
]

// 生成的版本
generatedVersions: [
  { title, content }
]
```

**交互逻辑**:
- 输入提示词 → 实时字数统计
- 选择分类 → 过滤显示对应模板
- 点击模板 → 填充到输入框
- 点击生成 → 
  - 检查点数余额
  - 显示生成动画
  - 模拟生成歌词（3秒）
  - 展示结果
- 切换版本 → 更新显示内容
- 点击"返回修改提示词" → 
  - 确认弹窗
  - 清空生成结果
  - 返回输入状态
- 点击"继续创作" → 
  - 携带歌词数据
  - 跳转到风格选择页面

**需要的API接口**:
1. `POST /api/ai/generate-lyrics` - AI生成歌词
2. `GET /api/user/points/check` - 检查点数余额
3. `POST /api/user/points/consume` - 消费点数

---

### 2.4 自主创作页 (`/pages/creation/manual`)

**页面定位**: 用户手动输入歌词内容

**UI布局**:
```
┌───────────────────────────────┐
│  < 返回    自主创作   帮助 ?  │
├───────────────────────────────┤
│  歌曲标题                      │
│  ┌─────────────────────────┐  │
│  │ [输入框]          20/20 │  │
│  └─────────────────────────┘  │
│  请勿输入违规、侵权或敏感内容  │
├───────────────────────────────┤
│  歌词内容      最多400字  📋  │
│  ┌─────────────────────────┐  │
│  │                         │  │
│  │ [文本域]                │  │
│  │                         │  │
│  │                         │  │
│  │                         │  │
│  │                 400/400 │  │
│  └─────────────────────────┘  │
├───────────────────────────────┤
│  自动保存：刚刚                │
├───────────────────────────────┤
│  [下一步]                     │
└───────────────────────────────┘
```

**核心功能**:

1. **歌曲标题输入**
   - 最多20个字
   - 实时字数统计
   - 输入验证（非空）

2. **歌词内容输入**
   - 最多400个字
   - 实时字数统计
   - 多行文本输入
   - 字数超限提示（橙色警告、红色错误）

3. **自动保存草稿**
   - 每30秒自动保存到本地
   - 保存时间显示
   - 页面卸载时保存
   - 重新进入自动恢复

4. **输入验证**
   - 标题不能为空
   - 歌词不能为空
   - 歌词不能超过400字
   - 敏感词过滤（待实现）

5. **草稿管理**
   - 存储键: `manual_draft`
   - 存储内容: { songTitle, lyrics, saveTime }
   - 退出时提示保存

**数据结构**:

```javascript
data: {
  songTitle: '',        // 歌曲标题
  lyrics: '',           // 歌词内容
  lastSaveTime: '刚刚', // 最后保存时间
  isDirty: false        // 是否有未保存修改
}
```

**交互逻辑**:
- 输入标题 → 
  - 实时字数统计
  - 标记为未保存
  - 触发自动保存
  
- 输入歌词 →
  - 实时字数统计
  - 超过360字显示警告
  - 超过400字显示错误并禁用下一步
  - 标记为未保存
  - 触发自动保存

- 点击"下一步" →
  - 验证标题和歌词
  - 保存草稿
  - 携带数据跳转到风格选择页面

- 点击返回 →
  - 检查是否有未保存修改
  - 有修改：显示保存提示弹窗
  - 无修改：直接返回

---

### 2.5 风格选择页 (`/pages/creation/style`)

**页面定位**: 选择音乐风格和声音类型

**UI布局**:
```
┌───────────────────────────────┐
│  < 返回    风格设置           │
├───────────────────────────────┤
│  风格类型                      │
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐    │
│  │流行│ │摇滚│ │民谣│ │电子│    │
│  └───┘ └───┘ └───┘ └───┘    │
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐    │
│  │R&B│ │嘻哈│ │古典│ │爵士│    │
│  └───┘ └───┘ └───┘ └───┘    │
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐    │
│  │乡村│ │抒情│ │EDM│ │独立│    │
│  └───┘ └───┘ └───┘ └───┘    │
├───────────────────────────────┤
│  声音性别                      │
│  ┌─────┐ ┌─────┐ ┌─────┐    │
│  │ 男声 │ │ 女声 │ │ 中性 │    │
│  └─────┘ └─────┘ └─────┘    │
├───────────────────────────────┤
│  [返回修改歌词] [下一步 →]    │
└───────────────────────────────┘
```

**核心功能**:

1. **音乐风格选择**
   - 12种预设风格（3x4网格布局）
   - 流行、摇滚、民谣、电子、R&B、嘻哈、古典、爵士、乡村、抒情、EDM、独立
   - 单选，选中高亮显示（蓝色边框）
   - 默认选中"流行"

2. **声音性别选择**
   - 3种声音类型（横向排列）
   - 男声、女声、中性
   - 单选，选中高亮显示
   - 默认选中"女声"

3. **声音参考试听（功能待完善）**
   - 显示当前选择
   - 播放示例音频
   - 帮助用户决策

**数据结构**:

```javascript
data: {
  creationType: 'ai',      // 创作类型：ai/manual
  songTitle: '',           // 歌曲标题（从上一页传入）
  lyrics: '',              // 歌词内容（从上一页传入）
  selectedStyle: 'pop',    // 选中的风格ID
  selectedVoice: 'female'  // 选中的声音ID
}

// 风格列表
musicStyles: [
  { id: 'pop', name: '流行', icon: 'icon-pop' },
  { id: 'rock', name: '摇滚', icon: 'icon-rock' },
  // ...
]

// 声音列表
voiceGenders: [
  { id: 'male', name: '男声', icon: 'icon-male' },
  { id: 'female', name: '女声', icon: 'icon-female' },
  { id: 'neutral', name: '中性', icon: 'icon-neutral' }
]
```

**交互逻辑**:
- 点击风格卡片 → 
  - 更新选中状态
  - 高亮显示

- 点击声音卡片 →
  - 更新选中状态
  - 高亮显示

- 点击"返回修改歌词" →
  - 返回上一页

- 点击"下一步" →
  - 验证选择（风格和声音必选）
  - 携带所有数据跳转到预览生成页面
  - 参数：type, title, lyrics, style, voice

**需要的API接口**:
- `GET /api/music/styles` - 获取风格列表（可选，前端硬编码）
- `GET /api/music/voices` - 获取声音列表（可选，前端硬编码）

---

### 2.6 音乐预览生成页 (`/pages/creation/preview`)

**页面定位**: 生成音乐并预览播放

**生成前布局**:
```
┌───────────────────────────────┐
│  < 返回    生成音乐           │
├───────────────────────────────┤
│  确认创作信息                  │
│  音乐风格          流行        │
│  声音类型          女声        │
├───────────────────────────────┤
│  [生成音乐]                   │
│  将消耗30音乐点数              │
└───────────────────────────────┘
```

**生成中布局**:
```
┌───────────────────────────────┐
│       AI正在创作中...          │
│  ┌─────────────────────────┐  │
│  │      加载动画            │  │
│  │      ● ● ●              │  │
│  └─────────────────────────┘  │
├───────────────────────────────┤
│  ▓▓▓▓▓▓▓▓░░░░░░░░  45%       │
├───────────────────────────────┤
│  💡 正在将您的歌词谱写成优美旋律│
│  ⏱️ 预计需要30-60秒完成创作    │
│  🎵 请耐心等待，将带来精彩作品  │
└───────────────────────────────┘
```

**生成后布局**:
```
┌───────────────────────────────┐
│  < 返回    音乐预览           │
├───────────────────────────────┤
│  ┌─────────────────────────┐  │
│  │                         │  │
│  │     [唱片封面旋转]       │  │
│  │                         │  │
│  └─────────────────────────┘  │
│        心动瞬间                │
│      流行 / 女声               │
├───────────────────────────────┤
│  00:45  ▓▓▓▓░░░░░░  03:25    │
├───────────────────────────────┤
│    ⏮    ▶️/⏸    ⏭           │
├───────────────────────────────┤
│  [下载]      [分享]           │
└───────────────────────────────┘
```

**核心功能**:

1. **确认创作信息**
   - 显示选择的风格和声音
   - 显示消耗点数
   - "生成音乐"按钮

2. **生成进度显示**
   - 加载动画（旋转圆圈）
   - 进度条（0-100%）
   - 进度提示文本
   - 模拟生成过程（30-60秒）

3. **音乐播放器**
   - 唱片封面（播放时旋转）
   - 歌曲标题和风格显示
   - 播放进度条（可拖拽）
   - 当前时间/总时长显示
   - 播放控制按钮：
     - 上一首（占位，当前无功能）
     - 播放/暂停（核心功能）
     - 下一首（占位，当前无功能）

4. **操作按钮**
   - 下载按钮：下载音乐到本地
   - 分享按钮：分享到微信好友/朋友圈

5. **歌词展示（可选，当前隐藏）**
   - 显示完整歌词
   - 支持展开/收起

**数据结构**:

```javascript
data: {
  creationType: 'ai',          // 创作类型
  songTitle: '心动瞬间',       // 歌曲标题
  lyrics: '',                  // 歌词
  styleId: 'pop',              // 风格ID
  voiceId: 'female',           // 声音ID
  songCover: '/path/to/cover', // 封面图片
  
  isGenerating: false,         // 是否正在生成
  generatingProgress: 0,       // 生成进度（0-100）
  
  isPlaying: false,            // 是否正在播放
  currentTime: 0,              // 当前播放时间（秒）
  duration: 180,               // 总时长（秒）
  
  musicPoints: 80              // 剩余点数
}
```

**交互逻辑**:

1. **点击"生成音乐"**:
   - 检查点数余额（需要30点）
   - 点数不足 → 显示弹窗，引导购买
   - 点数充足 → 
     - 扣除30点
     - 开始生成流程
     - 显示生成动画和进度

2. **生成完成**:
   - 隐藏生成界面
   - 初始化音频播放器
   - 显示播放控制界面
   - 自动加载音频文件

3. **播放控制**:
   - 点击播放/暂停按钮 → 切换播放状态
   - 点击进度条 → 跳转到指定位置
   - 音频播放完毕 → 自动停止，进度归零

4. **下载音乐**:
   - 显示下载提示
   - 调用下载API
   - 保存到本地相册或文件
   - 标记作品为"已下载"

5. **分享音乐**:
   - 调用微信分享API
   - 分享到好友/朋友圈
   - 分享成功获得5积分奖励

**需要的API接口**:
1. `POST /api/music/generate` - 生成音乐
   - 请求参数：title, lyrics, style, voice, type
   - 返回：taskId（生成任务ID）

2. `GET /api/music/generate/status` - 查询生成状态
   - 请求参数：taskId
   - 返回：status（生成状态）、progress（进度）、result（结果）

3. `POST /api/music/save` - 保存作品
   - 请求参数：title, lyrics, style, voice, audioUrl, coverUrl
   - 返回：workId（作品ID）

4. `POST /api/music/download` - 下载音乐
   - 请求参数：workId
   - 返回：downloadUrl（下载链接）

5. `POST /api/user/points/consume` - 消费点数
   - 请求参数：amount, reason
   - 返回：remainingPoints（剩余点数）

---

### 2.7 我的作品页 (`/pages/user/works`)

**页面定位**: 管理用户创作的所有作品

**UI布局**:
```
┌───────────────────────────────┐
│  < 返回  我的作品    管理     │
├───────────────────────────────┤
│  [搜索框]             [筛选]  │
├───────────────────────────────┤
│  ☁️ 云端作品保存3个月后将自动 │
│     删除，请及时下载重要作品   │
├───────────────────────────────┤
│  ⚠️ 您有2个作品即将过期 [查看]│
├───────────────────────────────┤
│  ┌─────────────────────────┐  │
│  │ [封面] 夏日晚风          │  │
│  │       已下载      ▶️    │  │
│  │       2023-06-15        │  │
│  │       流行        分享  │  │
│  └─────────────────────────┘  │
│  ┌─────────────────────────┐  │
│  │ [封面] 城市霓虹          │  │
│  │       云端 剩15天  ▶️   │  │
│  │       2023-06-10        │  │
│  │       电子        分享  │  │
│  └─────────────────────────┘  │
│  ...更多作品...              │
└───────────────────────────────┘
```

**管理模式布局**:
```
┌───────────────────────────────┐
│  < 返回  我的作品    完成     │
├───────────────────────────────┤
│  ☑ 全选                       │
│  ┌─────────────────────────┐  │
│  │ ☑ [封面] 夏日晚风        │  │
│  └─────────────────────────┘  │
│  ┌─────────────────────────┐  │
│  │ ☐ [封面] 城市霓虹        │  │
│  └─────────────────────────┘  │
├───────────────────────────────┤
│ [下载] [分享] [删除]          │
└───────────────────────────────┘
```

**核心功能**:

1. **搜索和筛选**
   - 搜索框：按作品标题搜索
   - 筛选按钮：按状态筛选
     - 全部
     - 已下载
     - 云端
     - 即将过期

2. **云存储提示**
   - 提示云端作品3个月后自动删除
   - 引导用户下载重要作品

3. **过期提醒**
   - 统计即将过期的作品数量（剩余天数<7天）
   - 醒目提示
   - 点击"查看"高亮显示过期作品

4. **作品列表**
   - 每个作品卡片包含：
     - 封面图片
     - 作品标题
     - 创作日期
     - 状态标签：
       - "已下载"（绿色）
       - "云端"（橙色）+ 剩余天数
     - 播放按钮
     - 音乐风格标签
     - 分享按钮
   - 支持左滑显示操作按钮：
     - 编辑（蓝色）
     - 删除（红色）

5. **管理模式**
   - 点击"管理"进入管理模式
   - 显示复选框
   - 全选/取消全选
   - 批量操作：
     - 批量下载
     - 批量分享
     - 批量删除
   - 点击"完成"退出管理模式

6. **空状态**
   - 当没有作品时显示空状态
   - 引导用户去创作
   - "开始创作"按钮跳转到创作选择页

**数据结构**:

```javascript
data: {
  works: [
    {
      id: '1',
      title: '夏日晚风',
      coverUrl: '/path/to/cover',
      createTime: '2023-06-15',
      duration: '03:25',
      isDownloaded: true,
      daysLeft: null,          // 剩余天数（未下载作品）
      isPlaying: false,
      selected: false,         // 是否被选中（管理模式）
      genre: '流行'
    }
  ],
  searchText: '',              // 搜索关键词
  isManageMode: false,         // 是否管理模式
  isAllSelected: false,        // 是否全选
  expiringWorks: []            // 即将过期的作品
}
```

**交互逻辑**:

1. **搜索作品**:
   - 输入关键词
   - 实时过滤作品列表

2. **筛选作品**:
   - 点击筛选按钮
   - 显示筛选选项
   - 选择筛选条件
   - 更新作品列表

3. **播放作品**:
   - 点击播放按钮
   - 切换当前作品播放状态
   - 停止其他作品播放

4. **查看详情**:
   - 点击作品卡片
   - 跳转到作品详情页

5. **分享作品**:
   - 点击分享按钮
   - 调用微信分享API
   - 分享成功获得积分

6. **左滑操作**:
   - 左滑作品卡片
   - 显示编辑和删除按钮
   - 点击编辑 → 跳转到编辑页面
   - 点击删除 → 显示确认弹窗 → 删除作品

7. **进入管理模式**:
   - 点击"管理"按钮
   - 显示复选框
   - 显示底部操作栏

8. **批量操作**:
   - 选择多个作品
   - 点击"下载" → 批量下载
   - 点击"分享" → 批量分享
   - 点击"删除" → 确认后批量删除

**需要的API接口**:
1. `GET /api/user/works` - 获取作品列表
   - 请求参数：page, pageSize, keyword, filter
   - 返回：works[]（作品列表）、total（总数）

2. `DELETE /api/user/works/:id` - 删除作品
   - 请求参数：workId
   - 返回：success

3. `POST /api/user/works/download` - 下载作品
   - 请求参数：workId
   - 返回：downloadUrl

4. `POST /api/user/works/share` - 分享作品
   - 请求参数：workId
   - 返回：shareData（分享数据）

5. `GET /api/user/works/expiring` - 获取即将过期的作品
   - 返回：expiringWorks[]

---

### 2.8 积分中心页 (`/pages/user/points`)

**页面定位**: 积分获取、消费和明细管理

**UI布局**:
```
┌───────────────────────────────┐
│  < 返回    音乐点数中心       │
├───────────────────────────────┤
│       当前点数余额             │
│          320                  │
│     上次更新：今天 10:30       │
├───────────────────────────────┤
│ [免费获取] [使用规则] [点数明细]│
├───────────────────────────────┤
│  转发作品                      │
│  每次转发获得5点，每日上限30点 │
│                    [去转发]   │
├───────────────────────────────┤
│  观看广告                      │
│  每次观看获得10点，今日还可3次 │
│                  [观看广告]   │
├───────────────────────────────┤
│  每日签到                      │
│  每日签到获得5点，连续签到翻倍 │
│                    [已签到]   │
├───────────────────────────────┤
│  邀请好友                      │
│  每邀请一位好友获得20点，无上限│
│                  [邀请好友]   │
├───────────────────────────────┤
│  购买点数                      │
│  ┌─────┐ ┌─────┐             │
│  │300点│ │600点│             │
│  │¥19.9│ │¥49.9│             │
│  └─────┘ └─────┘             │
│  ┌─────┐ ┌─────┐             │
│  │1200 │ │3000 │             │
│  │¥99.9│ │¥239.9│            │
│  └─────┘ └─────┘             │
│  [立即购买]                   │
└───────────────────────────────┘
```

**点数明细标签**:
```
┌───────────────────────────────┐
│  近30天的点数记录    [筛选日期]│
├───────────────────────────────┤
│  获取 +285  消耗 -140  净 +145│
├───────────────────────────────┤
│  今天                          │
│  ┌─────────────────────────┐  │
│  │ 观看广告          +10   │  │
│  │ 10:30                   │  │
│  ├─────────────────────────┤  │
│  │ 每日签到          +5    │  │
│  │ 09:15                   │  │
│  └─────────────────────────┘  │
│  昨天                          │
│  ┌─────────────────────────┐  │
│  │ 创作歌曲          -20   │  │
│  │ 《夏日晚风》            │  │
│  └─────────────────────────┘  │
│  ...更多记录...               │
└───────────────────────────────┘
```

**核心功能**:

1. **点数余额显示**
   - 大字号显示当前点数
   - 显示最后更新时间
   - 实时同步

2. **Tab标签页**
   - 免费获取
   - 使用规则
   - 点数明细
   - 支持URL参数切换（activeTab）

3. **免费获取方式**
   - **转发作品**：
     - 每次5点
     - 每日上限30点（6次）
     - 点击"去转发"跳转到作品列表
   
   - **观看广告**：
     - 每次10点
     - 每日上限3次
     - 显示剩余次数
     - 点击"观看广告"播放激励视频广告
   
   - **每日签到**：
     - 基础5点
     - 连续签到奖励翻倍
     - 显示签到状态（已签到/未签到）
     - 点击跳转到签到页面
   
   - **邀请好友**：
     - 每人20点
     - 无上限
     - 点击"邀请好友"生成邀请码/海报

4. **购买点数**
   - 4个套餐选项（2x2网格）：
     - 300点：¥19.9（赠送30点）- 首充特惠
     - 600点：¥49.9（赠送80点）- 热门
     - 1200点：¥99.9（赠送200点）
     - 3000点：¥239.9（赠送600点）
   - 支持选择套餐
   - 点击"立即购买"跳转到购买页面

5. **使用规则**
   - 展示点数使用规则
   - 创作消耗规则
   - 获取规则说明
   - 有效期说明

6. **点数明细**
   - **时间筛选**：
     - 默认显示近30天
     - 支持选择日期范围
   
   - **统计汇总**：
     - 获取总计（绿色）
     - 消耗总计（红色）
     - 净变动
   
   - **明细列表**：
     - 按日期分组显示
     - 今天/昨天/具体日期
     - 每条记录包含：
       - 操作类型（获取/消耗）
       - 标题和副标题
       - 时间
       - 点数变化（+/-）
     - 支持加载更多

**数据结构**:

```javascript
data: {
  userPoints: 320,              // 当前点数
  lastUpdateTime: '今天 10:30', // 最后更新时间
  activeTab: 'free',            // 当前标签页
  selectedPackage: 0,           // 选中的套餐
  adWatchRemaining: 3,          // 剩余广告次数
  checkedInToday: true,         // 今日是否已签到
  
  // 套餐列表
  pointsPackages: [
    { points: 300, originalPrice: 30, price: 19.9, bonus: 30, tag: '首充特惠' },
    { points: 600, originalPrice: 60, price: 49.9, bonus: 80, tag: '热门' },
    { points: 1200, originalPrice: 120, price: 99.9, bonus: 200 },
    { points: 3000, originalPrice: 300, price: 239.9, bonus: 600 }
  ],
  
  // 点数明细
  pointRecords: [
    {
      title: '观看广告',
      subtitle: null,
      time: '2023-06-16 10:30',
      points: 10,
      type: 'add'           // add: 获取, minus: 消耗
    }
  ],
  
  // 统计数据
  summary: {
    added: 285,             // 获取总计
    used: 140,              // 消耗总计
    net: 145                // 净变动
  }
}
```

**交互逻辑**:

1. **切换标签页**:
   - 点击Tab → 切换显示内容
   - URL参数支持：?activeTab=free/rules/history

2. **观看广告**:
   - 检查剩余次数
   - 次数充足 → 播放激励视频
   - 观看完成 → 增加10点，次数-1
   - 次数不足 → 提示明日再来

3. **每日签到**:
   - 已签到 → 按钮禁用，显示"已签到"
   - 未签到 → 跳转到签到页面

4. **邀请好友**:
   - 生成邀请码
   - 调用微信分享API
   - 好友注册成功 → 双方获得积分

5. **购买点数**:
   - 选择套餐（高亮显示）
   - 点击"立即购买"
   - 跳转到购买页面
   - 携带套餐信息

6. **加载点数明细**:
   - 按日期分组显示
   - 上拉加载更多
   - 支持日期筛选

**需要的API接口**:
1. `GET /api/user/points` - 获取点数余额
2. `POST /api/user/points/earn/share` - 分享获得积分
3. `POST /api/user/points/earn/ad` - 观看广告获得积分
4. `POST /api/user/points/earn/checkin` - 签到获得积分
5. `POST /api/user/points/earn/invite` - 邀请获得积分
6. `GET /api/user/points/records` - 获取点数明细
7. `GET /api/user/points/summary` - 获取统计汇总

---

### 2.9 每日签到页 (`/pages/user/checkin`)

**页面定位**: 每日签到打卡和连续签到奖励

**UI布局**:
```
┌───────────────────────────────┐
│  < 返回    每日签到           │
├───────────────────────────────┤
│  < 2023年6月 >                │
├───────────────────────────────┤
│  日 一 二 三 四 五 六          │
│              1  2  3          │
│  4  5  6  7  8  9  10         │
│  11 12 13 14 ✓  ✓  ✓         │
│  ✓  ✓  ✓  ✓  ✓  ✓  ✓         │
│  ✓  ✓  ✓  ✓                  │
├───────────────────────────────┤
│  连续签到奖励                  │
│  已连续签到 3 天               │
│  ┌─────┐ ┌─────┐             │
│  │1天  │ │3天  │             │
│  │5点 ✓│ │10点✓│             │
│  └─────┘ └─────┘             │
│  ┌─────┐ ┌─────┐             │
│  │7天  │ │15天 │             │
│  │15点 │ │30点 │             │
│  └─────┘ └─────┘             │
│  ┌─────┐                     │
│  │30天 │                     │
│  │50点 │                     │
│  └─────┘                     │
├───────────────────────────────┤
│  [今日签到]                   │
│  每日签到可获得5点数           │
└───────────────────────────────┘
```

**签到成功弹窗**:
```
┌─────────────────────┐
│  签到成功            │
│  已连续签到3天        │
│      +10            │
│    音乐点数          │
│  [领取奖励]          │
└─────────────────────┘
```

**核心功能**:

1. **月份日历**
   - 显示当前月份
   - 左右箭头切换月份
   - 星期几标题
   - 日期网格（7x5）

2. **签到状态**
   - 未到的日期：灰色
   - 已签到：绿色 + ✓图标
   - 今天：蓝色高亮
   - 未签到（过去）：红色提示（断签）

3. **连续签到奖励**
   - 5个里程碑：
     - 1天：5点
     - 3天：10点
     - 7天：15点
     - 15天：30点
     - 30天：50点
   - 显示当前连续天数
   - 已达成里程碑：显示"已领"标记
   - 可领取里程碑：显示"领取"按钮
   - 未达成：灰色显示

4. **签到按钮**
   - 未签到：显示"今日签到"按钮
   - 已签到：按钮禁用，显示"已签到"
   - 点击签到：
     - 显示签到中动画
     - 更新签到状态
     - 连续天数+1
     - 显示奖励弹窗

5. **奖励弹窗**
   - 显示签到成功
   - 显示连续天数
   - 显示获得点数
   - "领取奖励"按钮
   - 领取后关闭弹窗并返回

**数据结构**:

```javascript
data: {
  year: 2023,                   // 当前年份
  month: 6,                     // 当前月份（1-12）
  today: 16,                    // 今天日期
  streakDays: 3,                // 连续签到天数
  checkedDays: [1,2,...,15],    // 已签到日期列表
  isCheckedToday: false,        // 今日是否已签到
  showRewardPopup: false,       // 是否显示奖励弹窗
  todayReward: 10,              // 今日奖励点数
  
  // 里程碑配置
  milestones: [
    { days: 1, points: 5, claimed: true },
    { days: 3, points: 10, claimed: false },
    { days: 7, points: 15, claimed: false },
    { days: 15, points: 30, claimed: false },
    { days: 30, points: 50, claimed: false }
  ]
}
```

**计算属性**:
- firstDayOfMonth: 当月1号是星期几
- daysInMonth: 当月天数
- calendarDays: 日历显示的所有天数（包括上月和下月）

**交互逻辑**:

1. **切换月份**:
   - 点击左箭头 → 上一个月
   - 点击右箭头 → 下一个月
   - 重新获取签到数据

2. **每日签到**:
   - 检查是否已签到
   - 已签到 → 禁用按钮
   - 未签到 → 执行签到流程：
     1. 显示签到中提示
     2. 调用签到API
     3. 更新签到状态
     4. 连续天数+1
     5. 计算今日奖励
     6. 显示奖励弹窗

3. **计算奖励**:
   - 基础奖励：5点
   - 连续签到奖励：
     - 达到里程碑（1/3/7/15/30天）
     - 额外获得里程碑奖励

4. **领取里程碑奖励**:
   - 检查连续天数是否达到
   - 达到且未领取 → 显示"领取"按钮
   - 点击"领取" → 
     - 调用领取API
     - 增加点数
     - 标记为已领取

5. **断签处理**:
   - 如果某天未签到
   - 连续天数清零
   - 里程碑重新计算

**需要的API接口**:
1. `GET /api/user/checkin/calendar` - 获取签到日历
   - 请求参数：year, month
   - 返回：checkedDays[], streakDays, milestones[]

2. `POST /api/user/checkin` - 每日签到
   - 返回：points（获得点数）, streakDays（连续天数）

3. `POST /api/user/checkin/milestone/claim` - 领取里程碑奖励
   - 请求参数：milestoneId
   - 返回：points（获得点数）

---

### 2.10 热门推荐页 (`/pages/recommendations/index`)

**页面定位**: 展示平台热门音乐作品

**UI布局**:
```
┌───────────────────────────────┐
│  < 返回    热门推荐           │
├───────────────────────────────┤
│ [全部][流行][电子][摇滚]... → │
├───────────────────────────────┤
│  本周热门                      │
│  ┌─────┐ ┌─────┐             │
│  │封面1│ │封面2│             │
│  │夏日 │ │城市 │             │
│  │小明 │ │小红 │             │
│  │2.5k │ │1.8k │             │
│  └─────┘ └─────┘             │
├───────────────────────────────┤
│  精选推荐                      │
│  ┌─────┐ ┌─────┐             │
│  │封面3│ │封面4│             │
│  └─────┘ └─────┘             │
├───────────────────────────────┤
│  新人作品                      │
│  ┌─────┐ ┌─────┐             │
│  │封面5│ │封面6│             │
│  └─────┘ └─────┘             │
└───────────────────────────────┘
```

**核心功能**:

1. **分类筛选**
   - 7个分类：全部、流行、电子、摇滚、民谣、嘻哈、古典
   - 横向滚动
   - 选中高亮显示
   - 切换分类重新加载数据

2. **本周热门**
   - 展示本周播放量最高的作品
   - 2x2网格布局
   - 每个卡片包含：
     - 封面图片
     - 播放按钮（右下角）
     - 作品标题
     - 创作者
     - 播放次数
     - 热度标记（第一名）

3. **精选推荐**
   - 编辑精选的优质作品
   - 2x2网格布局
   - 卡片内容同上

4. **新人作品**
   - 新注册用户的首发作品
   - 2x2网格布局
   - 扶持新创作者

5. **播放预览**
   - 点击播放按钮
   - 播放音乐片段（30秒）
   - 显示播放动画（波形）

**数据结构**:

```javascript
data: {
  currentCategory: 'all',       // 当前分类
  
  categories: [
    { id: 'all', name: '全部' },
    { id: 'pop', name: '流行' },
    // ...
  ],
  
  weeklyHot: [
    {
      id: 'hot1',
      title: '夏日晚风',
      author: '小明',
      coverUrl: '/path/to/cover',
      playCount: 12000,
      isHot: true               // 是否显示热度标记
    }
  ],
  
  featured: [
    // 精选推荐数据
  ],
  
  newArtists: [
    // 新人作品数据
  ]
}
```

**交互逻辑**:

1. **切换分类**:
   - 点击分类标签
   - 更新当前分类
   - 重新加载对应分类的作品

2. **播放音乐**:
   - 点击播放按钮
   - 播放音乐预览（30秒）
   - 显示播放提示

3. **查看详情**:
   - 点击作品卡片
   - 跳转到作品详情页

4. **格式化播放次数**:
   - >= 10000: 显示"x.x万"
   - >= 1000: 显示"x.x千"
   - < 1000: 显示原数字

**需要的API接口**:
1. `GET /api/recommendations/weekly` - 获取本周热门
   - 请求参数：category（可选）
   - 返回：works[]

2. `GET /api/recommendations/featured` - 获取精选推荐
   - 请求参数：category（可选）
   - 返回：works[]

3. `GET /api/recommendations/new` - 获取新人作品
   - 请求参数：category（可选）
   - 返回：works[]

---

## 3. 页面间导航关系

```
首页 (index)
├─→ 新手指引 → 教程页 (tutorial)
├─→ 创作提示词 → AI创作页 (creation/ai)
├─→ 热门推荐 → 推荐页 (recommendations)
│   └─→ 作品卡片 → 作品详情页 (user/work-detail)
├─→ 音乐点数 → 积分中心 (user/points)
└─→ 查看全部 → 推荐页 (recommendations)

创作选择页 (creation/select) [TabBar]
├─→ 自己写歌词 → 自主创作页 (creation/manual)
│   └─→ 下一步 → 风格选择页 (creation/style)
└─→ AI帮我写 → AI创作页 (creation/ai)
    └─→ 继续创作 → 风格选择页 (creation/style)

风格选择页 (creation/style)
└─→ 下一步 → 预览生成页 (creation/preview)

预览生成页 (creation/preview)
├─→ 下载 → 保存到本地
├─→ 分享 → 微信分享
└─→ 完成 → 返回首页

用户中心 (user/index) [TabBar]
├─→ 查看明细 → 积分中心 (user/points)
├─→ 我的作品 → 作品管理页 (user/works)
│   └─→ 作品卡片 → 作品详情页 (user/work-detail)
├─→ 购买点数 → 积分中心 (user/points)
├─→ 每日签到 → 签到页 (user/checkin)
├─→ 用户协议 → 协议页 (user/agreement)
├─→ 隐私政策 → 隐私页 (user/privacy)
├─→ 版权说明 → 版权页 (user/copyright)
├─→ 帮助中心 → 帮助页 (user/help)
├─→ 意见反馈 → 反馈页 (user/feedback)
└─→ 关于我们 → 关于页 (user/about)

积分中心 (user/points)
├─→ 每日签到 → 签到页 (user/checkin)
└─→ 购买点数 → 购买页 (user/purchase)

签到页 (user/checkin)
└─→ 签到成功 → 返回积分中心

作品管理页 (user/works)
└─→ 作品卡片 → 作品详情页 (user/work-detail)
```

---

## 4. 数据流向总结

### 4.1 创作流程数据流

```
用户输入
  ↓
选择创作方式 (select)
  ↓
  ├─→ AI创作：提示词 → AI生成歌词
  └─→ 自主创作：用户输入歌词
  ↓
选择风格和声音 (style)
  ↓
生成音乐 (preview)
  - 消耗积分
  - 调用AI服务
  - 生成音频文件
  ↓
保存作品
  - 上传到云存储
  - 保存到数据库
  ↓
下载/分享
```

### 4.2 积分系统数据流

```
积分获取
  ├─→ 每日签到 (+5点)
  ├─→ 观看广告 (+10点)
  ├─→ 分享作品 (+5点)
  ├─→ 邀请好友 (+20点)
  └─→ 购买套餐 (+300~3000点)
  ↓
积分消费
  ├─→ AI生成歌词 (-10点)
  ├─→ 生成音乐 (-30点)
  └─→ 下载作品 (-5点)
  ↓
积分余额更新
  ↓
明细记录
```

---

## 5. 待完善功能清单

1. **AI创作页**
   - 歌词内容编辑功能
   - 重新生成功能
   - 版本对比功能

2. **风格选择页**
   - 声音参考试听功能

3. **预览生成页**
   - 实际AI音乐生成服务集成
   - 实时生成进度获取（WebSocket）
   - 歌词显示和滚动

4. **作品管理页**
   - 作品编辑功能
   - 作品排序功能
   - 批量导出功能

5. **积分中心**
   - 激励视频广告集成
   - 微信支付集成
   - 分享海报生成

6. **签到页**
   - 补签功能
   - 签到日历动画
   - 里程碑徽章系统

7. **推荐页**
   - 个性化推荐算法
   - 评论功能
   - 点赞功能

8. **教程页**
   - 视频教程播放
   - 交互式教程

9. **作品详情页**
   - 详细信息展示
   - 歌词显示
   - 评论区

---

## 6. 用户体验优化建议

1. **加载优化**
   - 添加骨架屏
   - 图片懒加载
   - 分页加载

2. **交互反馈**
   - 按钮点击反馈
   - 操作成功提示
   - 错误友好提示

3. **引导优化**
   - 首次使用引导
   - 功能提示气泡
   - 空状态引导

4. **性能优化**
   - 列表虚拟滚动
   - 防抖节流
   - 缓存策略

5. **无障碍支持**
   - 字体大小调节
   - 高对比度模式
   - 语音反馈

---

本文档详细描述了AI音乐创作助手小程序的所有页面结构和功能，为后续API开发和数据库设计提供了完整的需求依据。
