# éŸ³ä¹å¹³å°æœ¬åœ°å¼€å‘ç¯å¢ƒç®¡ç†è„šæœ¬

## ğŸ“‹ è„šæœ¬è¯´æ˜

æœ¬ç›®å½•åŒ…å«ä¸‰ä¸ªç”¨äºç®¡ç†æœ¬åœ°å¼€å‘ç¯å¢ƒçš„è„šæœ¬ï¼š

| è„šæœ¬ | è¯´æ˜ |
|------|------|
| `start-dev.sh` | å¯åŠ¨æ‰€æœ‰å¼€å‘ç¯å¢ƒæœåŠ¡ï¼ˆæ•°æ®åº“ + åç«¯ + ç®¡ç†åå°ï¼‰ |
| `stop-dev.sh` | åœæ­¢æ‰€æœ‰å¼€å‘ç¯å¢ƒæœåŠ¡ |
| `status-dev.sh` | æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨å¼€å‘ç¯å¢ƒ

```bash
cd /Users/bang/Documents/dev/miniprogram1/music
./start-dev.sh
```

è„šæœ¬ä¼šæŒ‰é¡ºåºæ‰§è¡Œï¼š
1. æ£€æŸ¥ Docker æ˜¯å¦è¿è¡Œ
2. å¯åŠ¨ MySQL å’Œ Redis å®¹å™¨
3. å¯åŠ¨åç«¯ API æœåŠ¡ï¼ˆç«¯å£ 3000ï¼‰
4. å¯åŠ¨ç®¡ç†åå°å‰ç«¯ï¼ˆç«¯å£ 5173ï¼‰

### 2. æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
./status-dev.sh
```

æ˜¾ç¤ºæ‰€æœ‰æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬ï¼š
- Docker æœåŠ¡çŠ¶æ€
- MySQLã€Redisã€Adminer å®¹å™¨çŠ¶æ€
- åç«¯ API æœåŠ¡çŠ¶æ€
- ç®¡ç†åå°å‰ç«¯çŠ¶æ€
- æ—¥å¿—æ–‡ä»¶ä½ç½®

### 3. åœæ­¢å¼€å‘ç¯å¢ƒ

```bash
./stop-dev.sh
```

è„šæœ¬ä¼šï¼š
1. åœæ­¢ç®¡ç†åå°å‰ç«¯
2. åœæ­¢åç«¯ API æœåŠ¡
3. è¯¢é—®æ˜¯å¦åœæ­¢æ•°æ®åº“æœåŠ¡ï¼ˆå¯é€‰ï¼‰
4. è¯¢é—®æ˜¯å¦æ¸…ç†æ—¥å¿—æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

## ğŸŒ æœåŠ¡è®¿é—®åœ°å€

å¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

| æœåŠ¡ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| åç«¯ API | http://localhost:3000/api | NestJS åç«¯æœåŠ¡ |
| ç®¡ç†åå° | http://localhost:5173 | Vue 3 ç®¡ç†ç•Œé¢ |
| æ•°æ®åº“ç®¡ç† | http://localhost:8080 | Adminer æ•°æ®åº“ç®¡ç†å·¥å…· |
| MySQL | localhost:3306 | ç”¨æˆ·: root, å¯†ç : root123456 |
| Redis | localhost:6379 | å¯†ç : redis123456 |

## ğŸ“ æ—¥å¿—æ–‡ä»¶

æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ `/tmp` ç›®å½•ï¼š

```bash
# æŸ¥çœ‹åç«¯å®æ—¶æ—¥å¿—
tail -f /tmp/backend_startup.log

# æŸ¥çœ‹ç®¡ç†åå°å®æ—¶æ—¥å¿—
tail -f /tmp/admin_startup.log
```

## ğŸ”§ è¿›ç¨‹ç®¡ç†

PID æ–‡ä»¶ä¿å­˜åœ¨ `/tmp` ç›®å½•ï¼š
- åç«¯ PID: `/tmp/backend_pid.txt`
- å‰ç«¯ PID: `/tmp/admin_pid.txt`

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Docker å¿…é¡»è¿è¡Œ**ï¼šå¯åŠ¨è„šæœ¬ä¼šæ£€æŸ¥ Docker æ˜¯å¦è¿è¡Œï¼Œå¦‚æœªè¿è¡Œè¯·å…ˆå¯åŠ¨ Docker Desktop

2. **ç«¯å£å ç”¨**ï¼šè„šæœ¬ä¼šè‡ªåŠ¨æ¸…ç†ç«¯å£ 3000 å’Œ 5173 çš„å ç”¨è¿›ç¨‹

3. **æ•°æ®åº“æŒä¹…åŒ–**ï¼šåœæ­¢æ•°æ®åº“æœåŠ¡ä¸ä¼šåˆ é™¤æ•°æ®ï¼Œæ•°æ®ä¿å­˜åœ¨ Docker å·ä¸­

4. **é¦–æ¬¡å¯åŠ¨**ï¼šé¦–æ¬¡å¯åŠ¨å¯èƒ½éœ€è¦ç­‰å¾…è¾ƒé•¿æ—¶é—´ï¼Œç­‰å¾…æ•°æ®åº“åˆå§‹åŒ–å’Œä¾èµ–å®‰è£…

## ğŸ› æ•…éšœæ’æŸ¥

### æœåŠ¡æ— æ³•å¯åŠ¨

```bash
# 1. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./status-dev.sh

# 2. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
tail -n 100 /tmp/backend_startup.log
tail -n 100 /tmp/admin_startup.log

# 3. æ‰‹åŠ¨æ¸…ç†ç«¯å£
lsof -ti :3000 | xargs kill -9  # æ¸…ç†åç«¯ç«¯å£
lsof -ti :5173 | xargs kill -9  # æ¸…ç†å‰ç«¯ç«¯å£

# 4. é‡å¯ Docker å®¹å™¨
cd /Users/bang/Documents/dev/miniprogram/backend
docker-compose restart mysql redis
```

### æ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥ MySQL å®¹å™¨çŠ¶æ€
docker ps | grep ai_music_mysql

# æµ‹è¯• MySQL è¿æ¥
docker exec ai_music_mysql mysqladmin ping -h localhost -uroot -proot123456

# æ£€æŸ¥ Redis å®¹å™¨çŠ¶æ€
docker ps | grep ai_music_redis

# æµ‹è¯• Redis è¿æ¥
docker exec ai_music_redis redis-cli -a redis123456 ping
```

### API è¯·æ±‚å¤±è´¥

```bash
# æµ‹è¯• API æ¥å£
curl http://localhost:3000/api/public/banner/list

# å¦‚æœè¿”å› 500 é”™è¯¯ï¼Œæ£€æŸ¥æ•°æ®åº“è¡¨ç»“æ„
# ç¡®ä¿æ‰€æœ‰è¡¨éƒ½æœ‰ deleted_at å­—æ®µ
```

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
/Users/bang/Documents/dev/miniprogram1/music/
â”œâ”€â”€ backend/              # åç«¯ NestJS é¡¹ç›®
â”œâ”€â”€ admin/                # ç®¡ç†åå° Vue 3 é¡¹ç›®
â”œâ”€â”€ miniprogram/          # å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ï¼ˆä¸åœ¨å¯åŠ¨è„šæœ¬ä¸­ï¼‰
â”œâ”€â”€ start-dev.sh          # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ stop-dev.sh           # åœæ­¢è„šæœ¬
â”œâ”€â”€ status-dev.sh         # çŠ¶æ€æŸ¥çœ‹è„šæœ¬
â””â”€â”€ DEV_SCRIPTS.md        # æœ¬æ–‡æ¡£
```

## ğŸ”„ å¼€å‘å·¥ä½œæµ

1. **æ¯å¤©å¼€å§‹å·¥ä½œ**
   ```bash
   ./start-dev.sh
   ```

2. **å¼€å‘è¿‡ç¨‹ä¸­**
   ```bash
   ./status-dev.sh          # éšæ—¶æŸ¥çœ‹æœåŠ¡çŠ¶æ€
   tail -f /tmp/backend_startup.log  # æŸ¥çœ‹åç«¯æ—¥å¿—
   ```

3. **ç»“æŸå·¥ä½œ**
   ```bash
   ./stop-dev.sh            # åœæ­¢æœåŠ¡
   # é€‰æ‹© N ä¿ç•™æ•°æ®åº“è¿è¡Œï¼ˆæ¨èï¼‰
   # é€‰æ‹© N ä¿ç•™æ—¥å¿—æ–‡ä»¶ï¼ˆæ¨èï¼‰
   ```

## ğŸ“§ é—®é¢˜åé¦ˆ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. è¿è¡Œ `./status-dev.sh` çš„è¾“å‡º
2. ç›¸å…³æ—¥å¿—æ–‡ä»¶å†…å®¹
3. é”™è¯¯ä¿¡æ¯æˆªå›¾
